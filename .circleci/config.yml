version: 2

## Definitions
defaults: &defaults
  environment:
    KUBELESS_VERSION: v1.0.0-alpha.8
    MINIKUBE_VERSION: v0.25.2
run_test: &run_test
  steps:
    - checkout
    - run: make bootstrap
    - run: ./script/integration-tests.sh ${CIRCLE_JOB}

#### End of definitions

workflows:
  version: 2
  kubeless:
    jobs:
      - stable/php
jobs:
  stable/ballerina:
    machine: true
    <<: *defaults
    <<: *run_test
  stable/dotnetcore:
    machine: true
    <<: *defaults
    <<: *run_test
  stable/golang:
    machine: true
    <<: *defaults
    <<: *run_test
  stable/java:
    machine: true
    <<: *defaults
    <<: *run_test
  stable/nodejs:
    machine: true
    <<: *defaults
    <<: *run_test
  stable/php:
    machine: true
    <<: *defaults
    <<: *run_test
  stable/python:
    machine: true
    <<: *defaults
    <<: *run_test
  stable/ruby:
    machine: true
    <<: *defaults
    <<: *run_test
  incubator/jvm:
    machine: true
    <<: *defaults
    <<: *run_test
